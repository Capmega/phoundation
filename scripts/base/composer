#!/usr/bin/php
<?php
/*
 * This script is a front end to PHP composer
 */
$usage = "./scripts/base/composer OPTIONS\n".
         "./scripts/base/composer\n";

$help  = "This is the help contents";

require_once(dirname(__FILE__).'/../../libs/startup.php');

try{
    load_libs('composer');

    if(argument('init')){
        /*
         * Setup a composer JSON data file
         */
        if(file_exists(ROOT.'composer.json')){
            throw new LengthException('Composer has already been initialized for this project', 'composeralreadyinitialized');
        }

        file_put_contents(ROOT.'composer.json', "// Auto generated by the BASE composer script. Modify as needed\n{}");
    }

    if(argument('install')){
        /*
         * Ensure that the composer.json file exists
         */
        if(!file_exists(ROOT.'composer.json')){
            throw new LengthException('Composer has not been initialized for this project, file "composer.json" not found in "'.str_log(ROOT).'"', 'composeralreadyinitialized');
        }

        composer_install();
    }

}catch(Exception $e){
    cli_error('scripts/base/composer: Failed', $e);
}
?>
